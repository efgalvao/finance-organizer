<div class="summary">
  <div class="summary-subtitle">
    Summary for <%= @account.name %> account:
  </div>
</div>

<div class="summary-item">
  Current TOTAL balance(account + stocks):<br />
  <div class="item-value">
  <%= number_to_currency(@account.stock_plus_balance, unit: 'R$', separator: ',', delimiter: '') %>
  </div>
</div>

<div class="summary-item">
  Account balance:<br />
  <div class="item-value">
  <%= number_to_currency((@account.last_balance.balance), unit: 'R$', separator: ',', delimiter: '') %>
  </div>
</div>

<div class="summary-item">
  Current total stocks value:<br />
  <div class="item-value">
  <%= number_to_currency(@account.total_stock_value, unit: 'R$', separator: ',', delimiter: '') %>
  </div>
</div>

<div class="summary-item">
  Total invested:<br />
  <div class="item-value">
  <%= number_to_currency(@account.total_invested, unit: 'R$', separator: ',', delimiter: '') %>
  </div>
</div>

<div class="summary-item">
  Total amount of stocks:<br />
  <div class="item-value">
  <%= @account.stocks.size %>
  </div>
</div>

<div class="chart-title">
  Stocks:
  </div>
<div class="summary-item">
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Name</th>
        <th>Shares</th>
        <th>Total Invested</th>
        <th>Average Price</th>
        <th>Current share value</th>
        <th>Current total amount</th>
      </tr>
    </thead>
    <tbody>
      <% @account.stocks.each do |stock| %>
        <tr>
          <td><%= link_to stock.name, stock_summary_path(stock) %></td>
          <td><%= stock.shares.count %></td>
          <td><%= stock.total_invested %></td>
          <td><%= stock.average_aquisition_price %></td>
          <td><%= stock.current_price %></td>
          <td><%= stock.updated_balance %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<div>
  <%= link_to 'Transactions', account_transactions_path(@account), class:'btn btn-success' %>
  <%= link_to 'Create new transaction', new_transaction_path(account_id: @account.id), :class => "btn btn-success ml-3" %>
</div>

<div class="chart-title">
  Dividends received by month(last 6 months):<br />
</div>
<div class="summary-chart">
  <%= line_chart @account.last_semester_total_dividends_received, precision: 8 %>
</div>

<div class="chart-title">
  Stocks prices(last 6 months):
</div>

<div class="summary-chart">
  <%= line_chart @account.stocks.map { |stock| {
      name: stock.name, data: stock.last_semester_prices
      } }, precision: 8 %>
</div>

<div class="summary-stocks">
  <% @account.stocks.each do |stock| %>
    <div class="summary-stock">
      <%= link_to stock.name, stock_summary_path(stock), class:"summary-stock" %>
    </div>
  <% end %>
</div>
