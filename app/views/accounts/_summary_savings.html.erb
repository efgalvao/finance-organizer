<div class="summary">
  <div class="summary-subtitle">
    Summary for <%= @account.name %> account:
  </div>
</div>

<div class="summary-item">
  Current balance:<br />
  <div class="item-value">
    <%= number_to_currency(@account.last_balance.balance, unit: 'R$', separator: ',', delimiter: '') %>
  </div>
</div>

<div class="summary-item">
   Incomes and expenses: <br />
  <table class='table table-hover'>
    <thead>
      <tr>
        <th>Month</th>
        <th>Incomes</th>
        <th>Expenses</th>
        <th>Final</th>
      </tr>
    </thead>
    <tbody>
      <% (0...12).each do |n| %>
      <% date = DateTime.current - n.month%>
      <tr>
        <td><%= date.strftime('%B, %Y') %></td>
        <td><%= number_to_currency(@account.incomes(date), unit: 'R$ ', separator: ',', delimiter: '') %></td>
        <td><%= number_to_currency(@account.expenses(date), unit: 'R$ ', separator: ',', delimiter: '') %></td>
        <td><%= number_to_currency(@account.total_balance(date), unit: 'R$ ', separator: ',', delimiter: '') %></td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>

<div>
  <%= link_to 'Transactions', account_transactions_path(@account), class:'btn btn-success' %>
  <%= link_to 'Create new transaction', new_transaction_path(account_id: @account.id), :class => "btn btn-success ml-3" %>
</div>

<div class="chart-title">
  Monthly balance(last 6 months):<br />
</div>
<div class="summary-chart">
  <%= line_chart @account.last_semester_balances, precision: 8 %>
</div>
